var _=Object.defineProperty,N=Object.defineProperties;var x=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var E=(n,e,t)=>e in n?_(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,p=(n,e)=>{for(var t in e||(e={}))I.call(e,t)&&E(n,t,e[t]);if(y)for(var t of y(e))w.call(e,t)&&E(n,t,e[t]);return n},m=(n,e)=>N(n,x(e));var C=(n,e,t)=>(E(n,typeof e!="symbol"?e+"":e,t),t);const B=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}};B();class A{constructor(e){C(this,"listeners",[]);this._value=e}notify(){this.listeners.forEach(e=>e(this._value))}subscribe(e){this.listeners.push(e)}get value(){return this._value}set value(e){e!==this._value&&(this._value=e,this.notify())}}const g=/\+\d*$/,b=(...n)=>n.every(e=>e.checkValidity()),D=({user:n,isEdit:e,onChange:t,onDelete:r})=>{const s=document.createElement("tr"),o=s.insertCell(0);o.classList.add("user-table__cell");const u=s.insertCell(1);return u.classList.add("user-table__cell"),()=>{if(e){const a=document.createElement("input");a.value=n.name,a.required=!0;const d=document.createElement("input");d.value=n.phone,d.required=!0,d.pattern=g.source;const i=document.createElement("button");i.appendChild(document.createTextNode("save"));const v=()=>{console.log(b(a,d)),i.disabled=!b(a,d)};a.addEventListener("input",v),d.addEventListener("input",v),i.addEventListener("click",()=>{t(m(p({},n),{name:a.value,phone:d.value,isEdit:!1}))}),o.appendChild(a),u.append(d,i)}else{const a=document.createElement("button");a.appendChild(document.createTextNode("edit")),a.addEventListener("click",()=>{t(m(p({},n),{isEdit:!0}))}),o.appendChild(document.createTextNode(n.name)),u.append(document.createTextNode(n.phone),a)}const c=document.createElement("button");return c.appendChild(document.createTextNode("remove")),c.addEventListener("click",()=>r(n)),u.appendChild(c),s}},F=({onChange:n,onDelete:e})=>{const t=document.createElement("table");t.classList.add("user-table");const s=t.createTHead().insertRow(0),o=document.createElement("th");o.classList.add("user-table__header-cell");const u=document.createElement("th");u.classList.add("user-table__header-cell"),o.appendChild(document.createTextNode("\u0418\u043C\u044F")),u.appendChild(document.createTextNode("\u0422\u0435\u043B\u0435\u0444\u043E\u043D")),s.append(o,u);const c=t.createTBody();return({users:a})=>{Array.from(c.rows).forEach(l=>l.remove());const i=l=>e(l),v=l=>{const f=[...a],U=a.findIndex(T=>T.id===l.id);f.splice(U,1,l),n(f)};return a.map(l=>{const f=D({user:l,isEdit:l.isEdit,onChange:v,onDelete:i});c.appendChild(f())}),t}};const O=({onAdd:n})=>{const e=document.createElement("form");e.classList.add("user-add-form");const t=document.createElement("input");t.required=!0,t.classList.add("unvalidated");const r=document.createElement("input");r.required=!0,r.pattern=g.source,r.classList.add("unvalidated");const s=document.createElement("button");return s.appendChild(document.createTextNode("add")),e.addEventListener("submit",o=>{o.preventDefault(),b(t,r)&&n({name:t.value,phone:r.value})}),e.append(t,r,s),e},R=[{id:"1",name:"\u0410\u043D\u0434\u0440\u0435\u0439",phone:"+79001234578"},{id:"2",name:"\u0412\u0430\u043B\u0435\u0440\u0438\u0439",phone:"+79001234578"},{id:"3",name:"\u041C\u0430\u043A\u0441\u0438\u043C",phone:"+79001234578"},{id:"4",name:"\u0410\u043B\u0435\u043A\u0441\u0430\u043D\u0434\u0440",phone:"+79001234578"},{id:"5",name:"\u0410\u0440\u0442\u0435\u043C",phone:"+79001234578"}];let h=[...R];const L=()=>h,q=n=>{const e=Math.random().toString(36).substring(7),t=m(p({},n),{id:e});return h.push(t),t},k=n=>(h=h.filter(e=>e.id!==n.id),h),M=n=>{const e=L(),t=d=>m(p({},d),{isEdit:!1}),r=new A(e.map(t)),s=d=>{r.value=d},o=d=>{q(d),r.value=L().map(t)},c=F({onChange:s,onDelete:d=>{const i=k(d);r.value=i.map(t)}}),a=O({onAdd:o});r.subscribe(d=>c({users:d})),r.subscribe(console.log),n.append(c({users:r.value}),a)},S=()=>{const n=document.getElementById("app");M(n)};document.addEventListener("DOMContentLoaded",S);
